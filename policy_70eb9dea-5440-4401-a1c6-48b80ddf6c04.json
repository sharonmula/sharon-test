{
  "format": "rego",
  "policy": "# METADATA\n# custom:\n#   plainid:\n#     policyId: 70eb9dea-5440-4401-a1c6-48b80ddf6c04\n#     name: access_file_policy\n#     accessType: Allow\n#     policyUse: DYNAMIC_AUTHORIZATION_SERVICE\n#     sourceEnvironmentId: a5f8e3f0-1791-42de-af06-e9b9c4a23b2c\n#     applications: \n#       - id: Access-file\n#     customAttributes:\n#       tag: \"full\"\npackage policy\nimport rego.v1\n\n# METADATA\n# custom:\n#   plainid:\n#     kind: DynamicGroup\n#     name: User All Users\n#     id: 9c1bfd12-d8b9-456e-bc0a-de3ed2a144b4\n#     description: \"Predefined Dynamic Group. All Users contains all organization's users defined in the IDP\"\ndynamic_group(identity) if {\n\tidentity.template == \"User\"\n}\n\n# METADATA\n# custom:\n#   plainid:\n#     kind: Ruleset\n#     name: groupid filtering\n#     id: 3c6217e2-42f6-435b-9cf5-8a76df66a186\nruleset(asset, identity, requestParams, action) if {\n\tasset.template == \"access-file\"\n\tidentity.template == \"User\"\n\tasset[\"path\"] == identity[\"uid\"]\n\taction.id in [\"access\"]\n}"
}